# 🎯 Render Environment Variable Setup - Step by Step

## Your Current Status
- ✅ **Port Binding:** FIXED (using port 10000)
- ❌ **ALLOWED_HOSTS:** NOT SET (causing 400 error)

---

## STEP-BY-STEP: Set ALLOWED_HOSTS in Render

### Step 1: Open Render Dashboard
Go to: https://dashboard.render.com

### Step 2: Find Your Service
- You should see a service named **"url-monitor"**
- Click on it

### Step 3: Go to Environment Tab
- Look for tabs: **Events | Logs | Shell | Environment | Settings**
- Click **"Environment"**

### Step 4: Check if ALLOWED_HOSTS Exists

#### If ALLOWED_HOSTS Already Exists:
1. Find the row with key `ALLOWED_HOSTS`
2. Click the **pencil icon** (edit)
3. Make sure value is EXACTLY:
   ```
   url-monitor-2xlk.onrender.com
   ```
4. **NO** `https://`
5. **NO** trailing `/`
6. **NO** quotes
7. Click **"Save Changes"**

#### If ALLOWED_HOSTS Does NOT Exist:
1. Click **"Add Environment Variable"** button
2. In the **Key** field, type:
   ```
   ALLOWED_HOSTS
   ```
3. In the **Value** field, type:
   ```
   url-monitor-2xlk.onrender.com
   ```
4. Click **"Save Changes"**

### Step 5: Wait for Redeploy
- Render will automatically redeploy (2-3 minutes)
- Watch the **"Events"** tab for progress
- Look for: "Deploy succeeded" message

### Step 6: Test Your Site
Open in browser:
```
https://url-monitor-2xlk.onrender.com
```

Should now show your Django app instead of 400 error!

---

## ✅ Complete Environment Variables List

After setup, you should have these variables set:

### Auto-Generated by Render:
- `SECRET_KEY` (auto-generated - don't change)
- `DATABASE_URL` (auto-linked to PostgreSQL)
- `REDIS_URL` (auto-linked to Redis)
- `CELERY_BROKER_URL` (should match REDIS_URL)
- `CELERY_RESULT_BACKEND` (should match REDIS_URL)

### You Need to Add:
- ✅ `ALLOWED_HOSTS` = `url-monitor-2xlk.onrender.com`
- ✅ `DEBUG` = `False`

### Optional (for notifications):
- `EMAIL_HOST` = `smtp.gmail.com`
- `EMAIL_PORT` = `587`
- `EMAIL_USE_TLS` = `True`
- `EMAIL_HOST_USER` = `your-email@gmail.com`
- `EMAIL_HOST_PASSWORD` = `your-app-password`
- `TELEGRAM_BOT_TOKEN` = `your-bot-token`
- `SLACK_WEBHOOK_URL` = `your-webhook-url`

---

## 🔍 Verify It Worked

### Check Logs After Redeploy:
```
✅ Listening at: http://0.0.0.0:10000
✅ Booting worker with pid: XX
✅ Your service is live 🎉
```

### Test in Browser:
1. Open: `https://url-monitor-2xlk.onrender.com`
2. Should see: Login page or dashboard
3. Should NOT see: 400 Bad Request

### Test in Terminal:
```bash
curl https://url-monitor-2xlk.onrender.com
```
Should return HTML (not error)

---

## 🐛 Still Getting 400?

### Common Mistakes:

❌ **Wrong:** `ALLOWED_HOSTS=https://url-monitor-2xlk.onrender.com`  
✅ **Correct:** `ALLOWED_HOSTS=url-monitor-2xlk.onrender.com`

❌ **Wrong:** `ALLOWED_HOSTS=url-monitor-2xlk.onrender.com/`  
✅ **Correct:** `ALLOWED_HOSTS=url-monitor-2xlk.onrender.com`

❌ **Wrong:** `ALLOWED_HOSTS="url-monitor-2xlk.onrender.com"`  
✅ **Correct:** `ALLOWED_HOSTS=url-monitor-2xlk.onrender.com`

❌ **Wrong:** Typo in domain name  
✅ **Correct:** Check spelling carefully

### Debug Steps:

1. **Check the variable is saved:**
   - Go back to Environment tab
   - Verify ALLOWED_HOSTS appears in the list

2. **Check deployment succeeded:**
   - Go to Events tab
   - Look for "Deploy succeeded" (not failed)

3. **Run diagnostic script in Render Shell:**
   ```bash
   python diagnose_allowed_hosts.py
   ```

4. **Hard refresh browser:**
   - Press `Ctrl + Shift + R` (Windows/Linux)
   - Press `Cmd + Shift + R` (Mac)

5. **Check from different network:**
   - Try from phone (not WiFi)
   - Try incognito/private window

---

## 📸 Visual Guide

### What the Environment Tab Should Look Like:

```
┌─────────────────────────────────────────────────┐
│ Environment Variables                           │
├─────────────────────────────────────────────────┤
│ [Add Environment Variable]                      │
├─────────────────────────────────────────────────┤
│ ALLOWED_HOSTS                                   │
│ url-monitor-2xlk.onrender.com              [Edit]│
├─────────────────────────────────────────────────┤
│ DEBUG                                           │
│ False                                      [Edit]│
├─────────────────────────────────────────────────┤
│ SECRET_KEY                                      │
│ ••••••••••••••••••••••••••••••            [Edit]│
├─────────────────────────────────────────────────┤
│ DATABASE_URL                                    │
│ postgres://...                             [Edit]│
├─────────────────────────────────────────────────┤
│ REDIS_URL                                       │
│ redis://...                                [Edit]│
└─────────────────────────────────────────────────┘
```

---

## 🎯 Quick Reference Card

**Problem:** 400 Bad Request  
**Cause:** Django doesn't recognize your domain  
**Solution:** Add domain to ALLOWED_HOSTS  

**Where:** Render Dashboard → Service → Environment  
**Key:** `ALLOWED_HOSTS`  
**Value:** `url-monitor-2xlk.onrender.com`  
**No:** https://, quotes, or slashes  
**Wait:** 2-3 minutes after saving  
**Test:** Open URL in browser  

---

## Need More Help?

### Run Diagnostic:
```bash
# In Render Shell
python diagnose_allowed_hosts.py
```

### Check Documentation:
- [FIX_400_BAD_REQUEST.md](FIX_400_BAD_REQUEST.md) - Detailed troubleshooting
- [RENDER_TROUBLESHOOTING.md](RENDER_TROUBLESHOOTING.md) - General deployment issues
- [QUICK_DEPLOY.md](QUICK_DEPLOY.md) - Complete deployment guide

### Contact Support:
- Render Support: https://render.com/docs/support
- GitHub Issues: https://github.com/MDhruv03/URL-Monitor/issues

---

**Your Service URL:** https://url-monitor-2xlk.onrender.com  
**Last Updated:** October 25, 2025  
**Status:** Awaiting ALLOWED_HOSTS configuration
